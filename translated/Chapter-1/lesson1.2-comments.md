

1.2 — 注释  
===============

[*作者：Alex*](https://www.learncpp.com/author/Alex/ "查看 Alex 的所有文章")  
2025年3月19日（首次发布于2007年5月30日）  

**注释（comment）**是程序员直接插入源代码的可读性说明文字。编译器会忽略注释内容，注释仅用于程序员辅助理解代码。  

在C++中，有两种不同风格的注释方式，其核心功能相同：帮助程序员以某种方式记录代码。  

单行注释  
----------------  

`//`符号开启C++单行注释，编译器将忽略从`//`到行尾的所有内容。例如：  
```cpp
std::cout << "Hello world!"; // 从这里到行尾的内容将被忽略
```  

单行注释通常用于对单行代码进行快速说明：  
```cpp
std::cout << "Hello world!\n"; // std::cout位于iostream库
std::cout << "It is very nice to meet you!\n"; // 这类注释会影响代码可读性
std::cout << "Yeah!\n"; // 特别是当行长度不一致时
```  

在代码行右侧添加注释可能导致代码和注释都难以阅读（尤其是长代码行时）。若代码行较短，可将注释对齐（通常使用制表符）：  
```cpp
std::cout << "Hello world!\n";                 // std::cout位于iostream库
std::cout << "It is very nice to meet you!\n"; // 这样可读性更好
std::cout << "Yeah!\n";                        // 您是否也这样认为？
```  

对于长代码行，建议将单行注释置于被注释代码的上方：  
```cpp
// std::cout位于iostream库
std::cout << "Hello world!\n";

// 这样更易阅读
std::cout << "It is very nice to meet you!\n";

// 您是否也这样认为？
std::cout << "Yeah!\n";
```  

> **作者提示**  
> 本系列教程的示例分为两类：  
> * 完整程序（包含`main()`函数），可直接编译运行  
> * 代码片段（如上述语句），用于简明演示特定概念  
>  
> 代码片段无需编译。如需编译，请将其转换为完整程序（通常结构如下）：  
> ```cpp
> #include <iostream>
> 
> int main()
> {
>     // 在此替换为要编译的代码片段
>     return 0;
> }
> ```  

多行注释  
----------------  

`/*`和`*/`符号组合构成C风格多行注释，两符号间的所有内容将被忽略：  
```cpp
/* 这是多行注释。
   本行将被忽略。
   本行同样被忽略。 */
```  

程序员常通过添加左侧星号美化多行注释：  
```cpp
/* 这是多行注释。
 * 左侧对齐的星号
 * 可提升阅读体验
 */
```  

多行注释不可嵌套，否则将导致意外结果：  
```cpp
/* 这是多行/*注释*/ 本部分不在注释内 */
// 上方注释在第一个*/处结束，而非第二个
```  

编译器将忽略第一个`/*`到第一个`*/`之间的内容。由于`本部分不在注释内 */`不被视为注释内容，编译器将尝试编译该部分，必然导致编译错误。此时语法高亮工具非常有用，不同颜色可清晰区分注释范围。  

> **警告**  
> 请勿在多行注释内嵌套其他多行注释。但在多行注释内包含单行注释是允许的。  

注释的合理使用  
----------------  

注释通常应用于三个场景：  

**第一**，对于库、程序或函数，注释应描述其*功能*。这类注释通常置于文件/库顶部或函数前：  
```cpp
// 本程序根据测试和作业成绩计算学生最终成绩
```

```cpp
// 本函数使用牛顿法近似求解给定方程的根
```

```cpp
// 以下代码根据稀有度、等级和权重因子生成随机物品
```  

这些注释让读者无需查看代码即可理解其功能，在团队协作中尤为重要。  

**第二**，在已描述的库/程序/函数内部，注释应说明*实现方式*：  
```cpp
/* 计算最终成绩的步骤：
   1. 汇总所有加权期中与作业成绩
   2. 除以总成绩数量获得百分比
   3. 根据百分比确定字母等级 */
```

```cpp
// 生成随机物品的步骤：
// 1) 将目标稀有度的物品加入列表
// 2) 根据等级和权重计算每项概率
// 3) 生成随机数
// 4) 匹配随机数对应物品
// 5) 返回对应物品
```  

这些注释帮助读者理解实现思路，而无需逐行分析。  

**第三**，在语句级别，注释应解释*原因*。劣质的语句注释会说明*代码在做什么*，而优质的应说明*为何这样做*。  

劣质示例：  
```cpp
// 将视野设为0
sight = 0;
```  
**原因**：通过语句即可看出功能  

优质示例：  
```cpp
// 玩家刚喝下失明药水，无法看见任何事物
sight = 0;
```  
**原因**：说明了设置视野为0的缘由  

劣质示例：  
```cpp
// 计算物品成本
cost = quantity * 2 * storePrice;
```  
**原因**：无法解释为何乘以2  

优质示例：  
```cpp
// 此处乘以2是因为物品按对购买
cost = quantity * 2 * storePrice;
```  
**原因**：阐明了公式设计思路  

程序员常需在多种方案间抉择，注释是记录决策原因的好方法：  
```cpp
// 选择链表而非数组，因数组插入效率过低
```

```cpp
// 使用牛顿法求根，因无确定性解法存在
```  

最后，注释应让不了解代码的人也能理解。切勿认为"这段代码意图显而易见"，实际上代码意图往往并不直观，且记忆消退速度远超预期。阅读单行代码容易，理解整体目标却困难。  

> **相关内容**  
> 变量声明语句的注释规范详见课程[1.7 — 关键字与标识符命名](https://www.learncpp.com/cpp-tutorial/keywords-and-naming-identifiers/)。  

> **最佳实践**  
> 充分注释代码，假设读者完全不了解代码功能。切勿假设自己会记住每个决策的缘由。  

> **作者提示**  
> 后续教程将在代码块中使用注释强调重点或辅助说明（确保程序仍可编译）。请注意这些注释主要用于教学目的，并非良好注释的示范。  

扩展知识  
----------------  

[Doxygen](https://www.doxygen.nl/)等文档生成工具可帮助：  
* 标准化代码文档格式  
* 生成图表、可视化及交叉引用  
* 导出文档至其他格式（如HTML）  

学习阶段无需这些工具，但未来在专业环境中可能接触使用。  

注释代码  
----------------  

将代码转换为注释称为**注释掉代码（commenting out）**，可临时排除部分代码：  

**单行注释**：  
```cpp
//    std::cout << 1;
```  

**多行注释**：  
```cpp
//    std::cout << 1;
//    std::cout << 2;
//    std::cout << 3;
```  
或  
```cpp
/*
    std::cout << 1;
    std::cout << 2;
    std::cout << 3;
*/
```  

注释代码的常见场景：  
1. 调试未完成代码时保证程序可运行  
2. 暂时禁用存在问题的代码  
3. 定位错误源（通过排除法）  
4. 新旧代码交替时保留旧代码参考  

各IDE注释操作方式：  
* **Visual Studio**：编辑菜单 > 高级 > 注释选择  
* **Code::Blocks**：编辑菜单 > 注释相关选项  
* **VS Code**：Ctrl+/ 切换注释  

> **技巧**  
> 若常规注释使用单行风格，可用多行注释来注释代码块避免冲突。如需注释含多行注释的代码块，可考虑使用`#if 0`预处理指令（详见课程[2.10 — 预处理器简介](https://www.learncpp.com/cpp-tutorial/introduction-to-the-preprocessor/#if0)）。  

总结  
----------------  
* **库/程序/函数级**：注释说明*功能*  
* **实现级**：注释说明*方法*  
* **语句级**：注释说明*原因*  

[下一课 1.3 — 对象与变量简介](https://www.learncpp.com/cpp-tutorial/introduction-to-objects-and-variables/)  
[返回目录](/)
[上一课 1.1 — 语句与程序结构](https://www.learncpp.com/cpp-tutorial/statements-and-the-structure-of-a-program/)