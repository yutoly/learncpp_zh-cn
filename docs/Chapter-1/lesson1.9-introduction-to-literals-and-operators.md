1.9 — 字面量与运算符简介  
=============================================  

[*作者：Alex*](https://www.learncpp.com/author/Alex/ "查看 Alex 的所有文章")  
2019年2月1日上午10:06（首次发布于2024年12月19日）  

字面量（Literals）  
----------------  

观察以下两条语句：  

```cpp
std::cout << "Hello world!";
int x { 5 };
```  

其中的`"Hello world!"`和`5`是什么？它们是字面量（literal）。**字面量（literal）**（也称**字面常量（literal constant）**）是直接插入源代码的固定值。  

字面量与变量都具有值（和类型）。与变量（可通过初始化和赋值设置/改变值）不同，字面量的值固定且不可更改。字面量`5`的值永远是`5`，因此字面量被称为常量。  

为明确区分字面量与变量，请看以下程序：  

```cpp
#include <iostream>

int main()
{
    std::cout << 5 << '\n'; // 打印字面量的值
    int x { 5 };
    std::cout << x << '\n'; // 打印变量的值
    return 0;
}
```  

第5行打印字面量`5`。编译器编译时生成让`std::cout`输出`5`的代码，这个`5`被直接编译进可执行文件。  

第7行创建变量`x`并用值`5`初始化。编译器生成将字面量`5`复制到`x`内存地址的代码。第8行打印`x`时，编译器生成从`x`内存地址读取值`5`的代码。  

两者输出结果相同（都是5）。但字面量直接输出值，而变量需要从内存地址读取值。  

这也解释了为何字面量不可变而变量可变：字面量的值被直接写入不可修改的可执行文件，变量的值存储在可修改的内存中。  

> **关键洞察**  
> 字面量是直接插入源代码的值，通常直接出现在可执行代码中（除非被优化掉）。  
> 对象和变量代表存储值的内存地址，这些值可按需读取。  

> **相关内容**  
> 更多字面量知识详见课程[5.2 — 字面量](Chapter-1/lesson1.9-introduction-to-literals-and-operators.md)。  

运算符（Operators）  
----------------  

数学中，**运算（operation）**是使用零或多个输入值（**操作数（operands）**）生成新值（输出值）的过程。表示具体运算的符号称为**运算符（operator）**。  

例如，*2 + 3 = 5*中，字面量2和3是操作数，*+*是应用加法运算的运算符。  

C++中的运算同理：  

```cpp
#include <iostream>

int main()
{
    std::cout << 1 + 2 << '\n';
    return 0;
}
```  

此程序中，字面量`1`和`2`是加号（`+`）运算符的操作数，生成返回值（return value）`3`并输出。C++中，运算的输出值常称为**返回值**。  

常见算术运算符包括加法（`+`）、减法（`-`）、乘法（`*`）、除法（`/`）。C++中赋值（`=`）、插入（`<<`）、提取（`>>`）和相等（`==`）也都是运算符。多数运算符使用符号（如`+`），部分使用关键字（如`new`、`delete`、`throw`）。  

> **作者提示**  
> 符号运算符常被命名为`operator+`（加号运算符）、`operator>>`（提取运算符）等形式。  

运算符的**元数（arity）**指其接收的操作数数量：  
- **一元运算符（unary operator）**作用于单个操作数（如负号运算符`-5`）  
- **二元运算符（binary operator）**作用于两个操作数（如加法`3 + 4`，插入运算符`std::cout << 5`）  
- **三元运算符（ternary operator）**作用于三个操作数（后续讲解）  
- **零元运算符（nullary operator）**无操作数（后续讲解）  

注意某些运算符根据上下文有不同含义。例如`operator-`可表示一元负号（`-5`）或二元减法（`4 - 3`）。  

运算符链式调用  
----------------  

运算符可链式调用，前者的返回值作为后者的输入。例如`2 * 3 + 4`中：  
1. 乘法运算符生成`6`  
2. 加法运算符使用`6`和`4`生成`10`  

运算顺序遵循数学中的优先级：括号→指数→乘除→加减（PEMDAS法则）。  

> **作者提示**  
> 某些国家使用PEDMAS、BEDMAS、BODMAS或BIDMAS等变体表示优先级。  

返回值与副作用（Return values and side effects）  
----------------  

多数运算符通过操作数计算返回值。如`-5`返回`-5`，`2 + 3`返回`5`。少数运算符（如`delete`、`throw`）无返回值。  

具有可观察效应（超出返回值）的运算符具有**副作用（side effect）**。例如：  
- `x = 5`的副作用是将`5`赋给`x`  
- `std::cout << 5`的副作用是向控制台输出`5`  

> **术语说明**  
> C++中"副作用"指运算符或函数在返回值之外的可见效应。赋值运算符的主要目的是其副作用（改变变量值），而`operator+`等运算符主要目的是返回值。  

> **进阶阅读**  
> 赋值运算符（`operator=`）和插入运算符（`operator<<`）返回左操作数，支持链式调用：  
> - `x = y = 5`等价于`x = (y = 5)`  
> - `std::cout << "Hello " << "world!"`等价于`(std::cout << "Hello ") << "world!"`  
> 运算符求值顺序详见课程[6.1 — 运算符优先级与结合律](Chapter-6/lesson6.1-operator-precedence-and-associativity.md)。  

测验时间  
----------------  

**问题1**  
以下代码输出什么？  
a)  
```cpp
std::cout << 3 + 4 << '\n';
```  
<details><summary>答案</summary>7</details>  

b)  
```cpp
std::cout << 3 + 4 - 5 << '\n';
```  
<details><summary>答案</summary>2</details>  

c)  
```cpp
std::cout << 2 + 3 * 4 << '\n';
```  
<details><summary>答案</summary>14（先计算3*4=12，再2+12）</details>  

d) 附加题：  
```cpp
int x { 2 };
std::cout << (x = 5) << '\n';
```  
<details><summary>答案</summary>5（赋值返回x的新值）</details>  

[下一课 1.10 — 表达式简介](Chapter-1/lesson1.10-introduction-to-expressions.md)  
[返回主页](/)  
[上一课 1.8 — 空白与基础格式](Chapter-1/lesson1.8-whitespace-and-basic-formatting.md)