1.1 — 语句与程序结构  
================================================

[*作者：Alex*](https://www.learncpp.com/author/Alex/ "查看 Alex 的所有文章")  
2025年3月17日（首次发布于2007年5月30日）  

本章导读  
----------------  

欢迎来到C++教程的第一个核心章节！  

本章中，我们将初步了解构建每个C++程序所必需的基础知识。由于涉及内容较多，多数主题将进行浅层讲解（满足基本需求即可）。本章目标是帮助您理解基础C++程序的构造方式。通过本章学习，您将能够编写简单的程序。  

后续章节中，我们将重新探讨这些主题并进行深度解析，同时介绍更多基于这些概念的新知识。  

为了控制单课长度，部分主题可能会拆分到后续课程。如果您发现某些重要概念未在当前课程中讲解，或疑问未得到解答，很可能相关内容会在下一课中涉及。  

语句（Statements）  
----------------  

计算机程序是一系列指示计算机操作的指令。**语句（statement）**是一种会引发程序*执行特定动作*的指令类型。  

在C++中，语句是最常见的指令形式。因为它们是C++语言中最小的独立计算单元，其作用类似于自然语言中的句子。当我们想向他人传达想法时，通常会使用完整句子（而非随机单词或音节）。在C++中，当需要程序执行操作时，我们也会编写语句。  

大多数（非全部）C++语句以分号结尾。若某行代码以分号结束，很可能就是一条语句。  

在C++这样的高级语言中，单条语句可能被编译为多条机器指令。  

> **进阶阅读**  
> C++包含多种语句类型：  
> * 声明语句（Declaration statements）  
> * 跳转语句（Jump statements）  
> * 表达式语句（Expression statements）  
> * 复合语句（Compound statements）  
> * 选择语句（Selection statements/条件语句）  
> * 迭代语句（Iteration statements/循环）  
> * try块（Try blocks）  
>  
> 完成本系列教程后，您将掌握所有这些概念！  

函数与main函数（Functions and the main function）  
----------------  

在C++中，语句通常被组织成称为**函数（function）**的单元。函数是按顺序（从上到下）执行的一组语句。学习编写程序时，您将能创建自定义函数并自由组合语句（后续课程将展示具体方法）。  

> **核心规则**  
> 每个C++程序必须包含名为**main**（全小写）的特殊函数。  

程序运行时，`main`函数内的语句将按顺序执行。程序通常在`main`函数最后一条语句执行后终止（某些情况下可能提前中止或执行后续清理）。  

函数通常被设计用于完成特定任务。例如：名为`max`的函数可能包含判断两个数字大小的语句；`calculateGrade`函数可能计算学生的考试成绩；`printEmployee`函数可能将员工信息打印到控制台。我们将在后续课程深入讨论函数——它们是程序中最常用的组织工具。  

> **命名惯例**  
> 讨论函数时，通常在函数名后附加括号作为简写。例如`main()`或`doSomething()`分别表示名为main和doSomething的函数。这有助于区分函数与其他命名实体（如变量）。  
>  
> 编程中，函数（或对象、类型、模板等）的名称称为**标识符（identifier）**。  

字符与文本（Characters and text）  
----------------  

早期计算机主要用于数学计算和数据处理。随着硬件发展、网络普及和消费级软件演进，计算机也成为文字交流的重要工具。  

书面语言最基本的交流单元是**字符（character）**。简而言之，字符是书写符号，包括字母、数字、标点和数学符号。敲击键盘字母或数字键时，会产生对应字符并显示于屏幕。例如：`a`、`2`、`$`和`=`都是字符。  

多数情况下（如书写单词或句子），我们需要使用多个字符。字符序列称为**文本（text）**（编程语境下也称**字符串（string）**）。  

> **术语说明**  
> 传统上，"text"也指**纯文本（plain text）**——即仅包含标准键盘字符且无特殊格式的文本。例如纯文本无法表示加粗文字，因为这需要样式支持。  
>  
> 我们的C++程序以纯文本形式编写。  

> **进阶阅读**  
> 计算机还有一类"控制字符（control character）"，这些字符对系统有特殊含义，通常不显示或显示为特殊符号。著名控制字符包括："escape"（不显示）、"tab"（显示为若干空格）和"backspace"（删除前一字符）。  

> **相关内容**  
> 字符和文本输出详见课程[1.5 — iostream简介：cout、cin与endl](Chapter-1/lesson1.5-introduction-to-iostream-cout-cin-and-endl.md)  
> 字符（含控制字符）的详细讨论见课程[4.11 — 字符](Chapter-4/lesson4.11-chars.md)  

解析Hello World程序  
----------------  

了解语句和函数的基本概念后，让我们重新审视"Hello world"程序，详细解析每行代码的作用：  

```cpp
#include <iostream>

int main()
{
   std::cout << "Hello world!";
   return 0;
}
```  

**第1行**是预处理器指令（preprocessor directive）。`#include`指令表示我们要使用`iostream`库的内容，这是C++标准库中负责控制台输入/输出的部分。需要此行才能在第五行使用`std::cout`。若省略将导致第五行编译错误，因为编译器无法识别`std::cout`。  

**第2行**为空行，编译器将忽略。该行仅为提高代码可读性（分隔预处理器指令与后续代码）。  

**第3行**声明名为`main`的函数。如前所述，所有C++程序必须包含`main`函数。该函数将返回`int`（整型）类型的值。  

**第4行和第7行**界定`main`函数的范围。左花括号（第4行）和右花括号（第7行）之间的内容构成函数体。  

**第5行**是`main`函数的第一条语句，也是程序运行时首条执行的语句。`std::cout`（"character output"缩写）与`<<`运算符用于向控制台输出文本。此处输出`Hello world!`，形成程序可见的输出结果。  

**第6行**是返回语句。程序运行结束时，会向操作系统返回状态值以指示执行状态。此处的`return 0`表示"程序正常完成"，这是程序执行的最后一条语句。  

我们编写的所有程序都将遵循此通用模板或其变体。  

> **作者提示**  
> 若对上述解释存在疑惑属正常现象。本节仅为概览，后续课程将深入讲解所有主题并提供丰富示例。  

您可以自行编译运行此程序，控制台将输出：  

```
Hello world!
```  

若遇到编译或执行问题，请参考课程[0.8 — 常见C++问题](Chapter-0/lesson0.8-a-few-common-cpp-problems.md)。  

语法与语法错误（Syntax and syntax errors）  
----------------  

英语句子需要遵循特定语法规则（如句尾加句号）。描述词语（及标点）如何有效组合形成句子的规则集合称为**语法（syntax）**。例如"My house painted is blue"存在语序错误，"All your base are belong to us!"是著名语法错误案例。  

C++语言也有自己的语法规范。编译程序时，编译器负责检查代码是否符合这些句法规则。若存在语法偏差，编译器将停止编译并抛出*语法错误（syntax error）*。  

与存在模糊性的英语不同，C++的语法规则严格且必须遵守。语法错误很常见，但通常易于发现和修复，因为编译器会直接指出错误位置。程序必须修正所有语法错误后才能完成编译。  

假设我们在"Hello world"程序的第五行省略分号：  

```cpp
#include <iostream>

int main()
{
   std::cout << "Hello world!"
   return 0;
}
```  

使用Clang编译时会产生以下错误信息：  

```
prog.cc:5:31: 错误: 表达式后应有';'
```  

Clang指出第五行第31个字符处缺少分号。而Visual Studio编译器则显示：  

```
c:\vcprojects\hello.cpp(6): 错误 C2143: 语法错误: 'return'前缺少';'
```  

注意两者报错行号不同。Clang基于惯例推断错误位于第五行，而Visual Studio在编译第六行发现`return`时代码结构异常。  

> **关键洞察**  
> 编译器有时会在实际错误行的下一行报错。若指示行未发现问题，请检查前一行。  

您可以通过删除字符或整行代码来观察不同的错误信息。例如恢复第五行分号后，尝试删除第1、3或4行。  

测验时间  
----------------  

**问题1**  
什么是语句？  
  
<details><summary>答案</summary>语句是计算机程序中指示执行动作的指令。</details>  

**问题2**  
什么是函数？  
  
<details><summary>答案</summary>函数是按顺序执行的语句集合。</details>  

**问题3**  
所有程序必须包含的函数名称是？  
  
<details><summary>答案</summary>main</details>  

**问题4**  
程序运行时会发生什么？  
  
<details><summary>答案</summary>main()中的语句按顺序执行。</details>  

**问题5**  
C++语句通常以什么符号结尾？  
  
<details><summary>答案</summary>分号（;）</details>  

**问题6**  
什么是语法错误？  
  
<details><summary>答案</summary>违反C++语法规则导致的错误。</details>  

**问题7**  
什么是C++标准库？  
[查看提示](javascript:void(0))  
<details><summary>提示</summary>复习课程[0.5 — 编译器、链接器与库简介](Chapter-0/lesson0.5-introduction-to-the-compiler-linker-and-libraries.md)</details>  
  
<details><summary>答案</summary>随C++提供的可重用代码库，包含扩展功能。</details>  

[下一课 1.2 注释](Chapter-1/lesson1.2-comments.md)  
[返回主页](/)  
[上一课 0.13 编译器使用的语言标准](Chapter-0/lesson0.13-what-language-standard-is-my-compiler-using.md)