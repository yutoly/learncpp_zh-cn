4.11 — 字符（Characters）  
================================================

[*作者：Alex*](https://www.learncpp.com/author/Alex/ "查看 Alex 的所有文章")  
2025年3月19日（首次发布于2007年6月9日）  

本章导读  
----------------  

此前讨论的基础数据类型主要用于存储数字（整数和浮点数）或真/假值（布尔类型）。但如何存储字母或标点符号呢？  

```
#include <iostream>

int main()
{
    std::cout << "要来份卷饼吗？(y/n)";

    // 如何让用户输入'y'或'n'字符？
    
    return 0;
}
```  

**字符类型（char）**专为存储单个字符设计。字符可以是字母、数字、符号或空白符。  

char属于整数类型，其底层以整数值存储。类似布尔类型中`0`为假、非零为真，char变量存储的整数被解释为**ASCII字符（ASCII character）**。  

**ASCII**（美国信息交换标准代码）定义了英文字符（及其他符号）与0-127数字（称为**ASCII码**或**码点**）的对应关系。例如ASCII码97对应字符'a'。  

字符字面量使用单引号包裹（如'g'、'1'、' '）。  

完整ASCII表如下：  

| 代码 | 符号              | 代码 | 符号    | 代码 | 符号   | 代码 | 符号        |
|------|-------------------|------|---------|------|--------|------|-------------|
| 0    | NUL（空字符）     | 32   | （空格）| 64   | @      | 96   | \`          |
| 1    | SOH（标题开始）   | 33   | !       | 65   | A      | 97   | a           |
| 2    | STX（正文开始）   | 34   | "       | 66   | B      | 98   | b           |
| 3    | ETX（正文结束）   | 35   | #       | 67   | C      | 99   | c           |
| 4    | EOT（传输结束）   | 36   | $       | 68   | D      | 100  | d           |
| 5    | ENQ（查询）       | 37   | %       | 69   | E      | 101  | e           |
| 6    | ACK（确认）       | 38   | &       | 70   | F      | 102  | f           |
| 7    | BEL（响铃）       | 39   | '       | 71   | G      | 103  | g           |
| 8    | BS（退格）        | 40   | (       | 72   | H      | 104  | h           |
| 9    | HT（水平制表）    | 41   | )       | 73   | I      | 105  | i           |
| 10   | LF（换行）        | 42   | *       | 74   | J      | 106  | j           |
| 11   | VT（垂直制表）    | 43   | +       | 75   | K      | 107  | k           |
| 12   | FF（换页）        | 44   | ,       | 76   | L      | 108  | l           |
| 13   | CR（回车）        | 45   | -       | 77   | M      | 109  | m           |
| 14   | SO（移出）        | 46   | .       | 78   | N      | 110  | n           |
| 15   | SI（移入）        | 47   | /       | 79   | O      | 111  | o           |
| 16   | DLE（数据链路转义）| 48   | 0       | 80   | P      | 112  | p           |
| 17   | DC1（设备控制1）  | 49   | 1       | 81   | Q      | 113  | q           |
| 18   | DC2（设备控制2）  | 50   | 2       | 82   | R      | 114  | r           |
| 19   | DC3（设备控制3）  | 51   | 3       | 83   | S      | 115  | s           |
| 20   | DC4（设备控制4）  | 52   | 4       | 84   | T      | 116  | t           |
| 21   | NAK（否定应答）    | 53   | 5       | 85   | U      | 117  | u           |
| 22   | SYN（同步空闲）    | 54   | 6       | 86   | V      | 118  | v           |
| 23   | ETB（传输块结束）  | 55   | 7       | 87   | W      | 119  | w           |
| 24   | CAN（取消）        | 56   | 8       | 88   | X      | 120  | x           |
| 25   | EM（介质结束）     | 57   | 9       | 89   | Y      | 121  | y           |
| 26   | SUB（替换）        | 58   | :       | 90   | Z      | 122  | z           |
| 27   | ESC（转义）        | 59   | ;       | 91   | [      | 123  | {           |
| 28   | FS（文件分隔符）   | 60   | <       | 92   | \      | 124  | \|          |
| 29   | GS（组分隔符）     | 61   | =       | 93   | ]      | 125  | }           |
| 30   | RS（记录分隔符）   | 62   | >       | 94   | ^      | 126  | ~           |
| 31   | US（单元分隔符）   | 63   | ?       | 95   | _      | 127  | DEL（删除）  |  

代码0-31和127称为**不可打印字符（unprintable characters）**，原用于控制打印机等外设。如今多数已废弃，打印时可能显示为表情符号（取决于操作系统）。  

代码32-126称为**可打印字符（printable characters）**，包含基本英文文本所需字符。  

若尝试打印超出ASCII范围的字符，结果取决于操作系统。  

字符初始化  
----------------  

可使用字符字面量初始化char变量：  

```
char ch2{ 'a' }; // 使用字符'a'的码位初始化（推荐）
```  

也可使用整数初始化（应尽量避免）：  

```
char ch1{ 97 };  // 使用整数97（'a'的ASCII码）初始化（不推荐）
```  

> **警告**  
> 注意区分数字字符与整数值：  
> ```
> char ch{5};    // 用整数5初始化（存储为5）
> char ch{'5'};  // 用字符'5'的码位初始化（存储为53）
> ```  

字符数字用于表示文本形式的数字，而非数学运算。  

打印字符  
----------------  

使用std::cout打印char变量时，会输出对应ASCII字符：  

```
#include <iostream>

int main()
{
    char ch1{ 'a' }; // 推荐方式
    std::cout << ch1; // 输出'a'

    char ch2{ 98 };   // 'b'的ASCII码（不推荐）
    std::cout << ch2; // 输出'b'

    return 0;
}
```  

输出结果：  

```
ab
```  

也可直接输出字符字面量：  

```
std::cout << 'c'; // 输出c
```  

输入字符  
----------------  

以下程序读取用户输入的字符并打印：  

```
#include <iostream>

int main()
{
    std::cout << "输入一个字符：";
    char ch{};
    std::cin >> ch;
    std::cout << "您输入了：" << ch << '\n';

    return 0;
}
```  

运行示例：  

```
输入一个字符：q
您输入了：q
```  

std::cin允许输入多个字符，但char变量只能存储第一个字符。剩余输入保留在缓冲区中，可通过后续std::cin调用提取。  

示例：  

```
#include <iostream>

int main()
{
    std::cout << "输入字符："; // 假设输入"abcd"

    char ch{};
    std::cin >> ch; // ch='a'，"bcd"留在缓冲区
    std::cout << "输入1：" << ch << '\n';

    std::cin >> ch; // ch='b'，"cd"留在缓冲区
    std::cout << "输入2：" << ch << '\n';
    
    return 0;
}
```  

输出：  

```
输入字符：abcd
输入1：a
输入2：b
```  

若需输入多个字符（如姓名或句子），应使用字符串（详见[5.7 — std::string简介](Chapter-5/lesson5.8-introduction-to-stdstring_view.md)）。  

提取空白字符  
----------------  

由于输入提取会跳过前导空白符，可能导致意外结果：  

```
#include <iostream>

int main()
{
    std::cout << "输入字符："; // 假设输入"a b"

    char ch{};
    std::cin >> ch; // 提取'a'，缓冲区剩余" b\n"
    std::cout << "输入1：" << ch << '\n';

    std::cin >> ch; // 跳过空格，提取'b'，缓冲区剩余"\n"
    std::cout << "输入2：" << ch << '\n';

    return 0;
}
```  

输出：  

```
输入字符：a b
输入1：a
输入2：b
```  

使用`std::cin.get()`可提取前导空白符：  

```
#include <iostream>

int main()
{
    std::cout << "输入字符："; // 假设输入"a b"

    char ch{};
    std::cin.get(ch); // 提取'a'，缓冲区剩余" b\n"
    std::cout << "输入1：" << ch << '\n';

    std::cin.get(ch); // 提取空格，缓冲区剩余"b\n"
    std::cout << "输入2：" << ch << '\n';

    return 0;
}
```  

输出：  

```
输入字符：a b
输入1：a
输入2：  
```  

字符大小、范围与符号  
----------------  

C++规定char类型始终占用1字节。默认情况下char可能带符号（通常）或不带符号。若仅存储ASCII字符，无需指定符号（0-127均可存储）。  

若用于存储小整数（非推荐做法），应显式指定符号：  
- 有符号char：-128 至 127  
- 无符号char：0 至 255  

转义序列  
----------------  

**转义序列（escape sequences）**是以反斜杠开头的特殊字符组合，常见如：  
- `'\n'`：换行  
- `'\t'`：水平制表符  
- `'\''`：单引号  
- `'\"'`：双引号  
- `'\\'`：反斜杠  

示例：  

```
#include <iostream>

int main()
{
    std::cout << "\"引号文本\"\n";
    std::cout << "包含单个反斜杠：\\\n";
    std::cout << "十六进制6F对应字符：'\x6F'\n";
    return 0;
}
```  

输出：  

```
"引号文本"
包含单个反斜杠：\
十六进制6F对应字符：'o'
```  

> **警告**  
> 转义序列使用反斜杠（\），而非正斜杠（/）。错误使用可能导致意外结果。  

换行符（\n）与std::endl  
----------------  

详见课程[1.5 — iostream简介](Chapter-1/lesson1.5-introduction-to-iostream-cout-cin-and-endl.md)。  

单引号与双引号区别  
----------------  

单引号包裹的是字符字面量（单个字符），如`'a'`、`'+'`、`'5'`（字符5，非数字5）、`'\n'`。  

双引号包裹的是C风格字符串字面量（多个字符），详见[5.2 — 字面量](Chapter-1/lesson1.9-introduction-to-literals-and-operators.md)。  

> **最佳实践**  
> 单字符应使用单引号，输出时可为统一格式使用双引号。  

避免多字符字面量  
----------------  

许多C++编译器支持**多字符字面量（multicharacter literals）**（如`'56'`），其值为编译器定义（非标准）。应避免使用。  

> **警告**  
> 确保换行符使用`'\n'`而非`'/n'`（正斜杠错误）。例如：  

错误代码：  

```
std::cout << add(1, 2) << '/n'; // 应使用'\n'
```  

可能输出意外值（如312142），而非预期的3后换行。  

其他字符类型  
----------------  

除char外：  
- `char16_t`和`char32_t`（C++11）：支持16/32位Unicode字符  
- `char8_t`（C++20）：8位Unicode（UTF-8）  
- `wchar_t`：宽度由实现定义（通常用于Windows API）  

建议仅使用ASCII字符，其他字符集可能导致显示问题。  

[下一课 4.12 — 类型转换与static_cast简介](Chapter-4/lesson4.12-introduction-to-type-conversion-and-static_cast.md)  
[返回主页](/)  
[上一课 4.10 — if语句简介](Chapter-4/lesson4.10-introduction-to-if-statements.md)