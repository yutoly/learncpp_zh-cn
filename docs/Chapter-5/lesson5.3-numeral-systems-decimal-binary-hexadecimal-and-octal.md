5.3 — 数值系统（十进制、二进制、十六进制与八进制）  
================================================

[*Alex*](https://www.learncpp.com/author/Alex/ "查看 Alex 的所有文章")  
2025年2月11日（首次发布于2022年6月16日）  
**作者注**：本课程为选修内容。后续课程将涉及十六进制数字，建议至少了解基本概念后再继续学习。

日常计数  
----------------  

日常生活中我们使用**十进制（decimal）**数字，每位数字可为0-9。十进制又称"基10（base 10）"系统（含10个可能数字）。其计数规律为：0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11,... 在C++中，默认假定数字为十进制：
```cpp
int x { 12 }; // 12被假定为十进制数
```

**二进制（binary）**仅使用0和1两个数字，故称"基2（base 2）"。二进制计数规律为：0, 1, 10, 11, 100, 101, 110, 111,... 为便于阅读，较长二进制数常以4位分组（如1101 0100）。十进制与二进制属于**数值系统（numeral systems）**——用于表示数字的符号集合。C++支持4种主要数值系统（按流行度排序）：  
* 十进制（基10）  
* 二进制（基2）  
* 十六进制（基16）  
* 八进制（基8）  

命名规则  
----------------  

十进制与二进制中，数字`0`和`1`含义相同，均称为"零"和"壹"。但数字`10`在两种系统中含义不同：  
* 十进制`10`表示九加一，称为"十"  
* 二进制`10`表示壹加壹（相当于十进制的二），应读作"壹零"而非"十"  

因此，"十"、"十一"等名称通常专属于十进制数字。非十进制系统中，我们使用逐位读法，如二进制101读作"壹零壹"而非"一百零一"。

八进制与十六进制字面量  
----------------  

**八进制（octal）**为基8系统，可用数字为0-7。计数规律：0, 1, 2, 3, 4, 5, 6, 7, 10, 11, 12,...（注意：跳过8和9，直接从7到10）：

| 十进制 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 |  
|--------|---|---|---|---|---|---|---|---|---|---|----|----|  
| 八进制 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 10 | 11 | 12 | 13 |  

使用八进制字面量时，需在数字前加前缀0（零）：
```cpp
#include <iostream>

int main()
{
    int x{ 012 }; // 前导0表示八进制
    std::cout << x << '\n';
    return 0;
}
```
该程序输出：
```
10
```
因默认以十进制输出，12（八进制）=10（十进制）。八进制极少使用，建议避免使用。

**十六进制（hexadecimal）**为基16系统。计数规律：0, 1, 2, 3, 4, 5, 6, 7, 8, 9, A, B, C, D, E, F, 10, 11, 12,...（字母可小写，但大写更常见）：

| 十进制 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 10 | 11 | 12 | 13 | 14 | 15 | 16 | 17 |  
|--------|---|---|---|---|---|---|---|---|---|---|----|----|----|----|----|----|----|----|  
| 十六进制 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | A | B | C | D | E | F | 10 | 11 |  

使用十六进制字面量时，需加前缀`0x`：
```cpp
#include <iostream>

int main()
{
    int x{ 0xF }; // 0x前缀表示十六进制
    std::cout << x << '\n';
    return 0;
}
```
输出：
```
15
```
前缀`0X`也可用，但`0x`更易阅读。

数值系统对照表  
----------------  

四种数值系统对照如下（展示递增规律）：

```
十进制         0     1     2     3     4     5     6     7     8     9    10    11    12    13    14    15
二进制          0     1    10    11   100   101   110   111  1000  1001  1010  1011  1100  1101  1110  1111
八进制           0     1     2     3     4     5     6     7    10    11    12    13    14    15    16    17
十六进制     0     1     2     3     4     5     6     7     8     9     A     B     C     D     E     F

十进制        16    17    18    19    20    21    22    23    24    25    26    27    28    29    30    31
二进制      10000 10001 10010 10011 10100 10101 10110 10111 11000 11001 11010 11011 11100 11101 11110 11111
八进制          20    21    22    23    24    25    26    27    30    31    32    33    34    35    36    37
十六进制    10    11    12    13    14    15    16    17    18    19    1A    1B    1C    1D    1E    1F
```
每行的模式相同：最右位从0递增至（基-1），达到基值时重置为0并向左进位。

用十六进制表示二进制  
----------------  

因十六进制数字含16种值（覆盖4位二进制），故两个十六进制数字可精确表示1字节：

| 十六进制 | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | A | B | C | D | E | F |  
|----------|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|---|  
| 二进制 | 0000 | 0001 | 0010 | 0011 | 0100 | 0101 | 0110 | 0111 | 1000 | 1001 | 1010 | 1011 | 1100 | 1101 | 1110 | 1111 |  

例如32位整数值`0011 1010 0111 1111 1001 1000 0010 0110`可简写为十六进制`3A7F 9826`。十六进制常用于表示内存地址或原始数据。

二进制字面量  
----------------  

C++14前无二进制字面量支持，可用十六进制替代：
```cpp
#include <iostream>

int main()
{
    int bin{};    // 假设为16位整型
    bin = 0x0001; // 赋值二进制0000 0000 0000 0001
    bin = 0x0002; // 赋值二进制0000 0000 0000 0010
    // ...其他赋值类似
    return 0;
}
```
C++14起支持`0b`前缀的二进制字面量：
```cpp
#include <iostream>

int main()
{
    int bin{};        
    bin = 0b1;        // 赋值二进制0000 0000 0000 0001
    bin = 0b11;       // 赋值二进制0000 0000 0000 0011
    bin = 0b1010;     // 赋值二进制0000 0000 0000 1010
    bin = 0b11110000; // 赋值二进制0000 0000 1111 0000
    return 0;
}
```

数字分隔符  
----------------  

C++14引入单引号`'`作为数字分隔符以提升可读性：
```cpp
#include <iostream>

int main()
{
    int bin { 0b1011'0010 };  // 赋值二进制1011 0010
    long value { 2'132'673'462 }; // 比2132673462更易读
    return 0;
}
```
分隔符不可位于首位：
```cpp
int bin { 0b'1011'0010 };  // 错误：在数字前使用分隔符
```

数值输出格式控制  
----------------  

默认十进制输出，可通过`std::dec`、`std::oct`、`std::hex`控制输出格式：
```cpp
#include <iostream>

int main()
{
    int x { 12 };
    std::cout << x << '\n'; // 十进制（默认）
    std::cout << std::hex << x << '\n'; // 十六进制
    std::cout << x << '\n'; // 保持十六进制
    std::cout << std::oct << x << '\n'; // 八进制
    std::cout << std::dec << x << '\n'; // 恢复十进制
    std::cout << x << '\n'; // 十进制
    return 0;
}
```
输出：
```
12
c
c
14
12
12
```
格式控制符会影响后续输出，直到再次变更。

二进制输出  
----------------  

需使用`<bitset>`头文件中的`std::bitset`：
```cpp
#include <bitset> 
#include <iostream>

int main()
{
    std::bitset<8> bin1{ 0b1100'0101 }; // 8位二进制字面量
    std::bitset<8> bin2{ 0xC5 }; // 十六进制字面量
    std::cout << bin1 << '\n' << bin2 << '\n';
    std::cout << std::bitset<4>{ 0b1010 } << '\n'; // 临时对象
    return 0;
}
```
输出：
```
11000101
11000101
1010
```

C++20/23新特性  
----------------  

C++20格式化库与C++23打印库支持更优二进制输出：
```cpp
#include <format> // C++20
#include <iostream>
#include <print>  // C++23

int main()
{
    std::cout << std::format("{:b}\n", 0b1010);  // 二进制输出
    std::cout << std::format("{:#b}\n", 0b1010); // 带0b前缀
    std::println("{:b} {:#b}", 0b1010, 0b1010); // C++23多参数打印
    return 0;
}
```
输出：
```
1010
0b1010
1010 0b1010
```

测验时间  
----------------  

**问题1**  
32的二进制与十六进制表示分别是？  
  
<details><summary>答案</summary>二进制：10 0000<br>十六进制：20</details>  

[下一课 5.4 — as-if规则与编译期优化](Chapter-5/lesson5.4-the-as-if-rule-and-compile-time-optimization.md)  
[返回主页](/)  
[[上一课 5.2 — 字面量](Chapter-1/lesson1.9-introduction-to-literals-and-operators.md)