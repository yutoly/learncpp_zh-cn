3.1 — 语法错误与语义错误  
================================================

[*作者：Alex*](https://www.learncpp.com/author/Alex/ "查看 Alex 的所有文章")  
2024年9月4日（首次发布于2019年2月1日）  

 

软件错误普遍存在。它们容易产生却难以发现。本章我们将探讨C++程序中的错误排查与修复相关主题，包括学习使用IDE集成的调试器。


尽管调试工具和技术不属于C++标准范畴，但掌握在自写程序中查找和消除错误的能力是成为优秀程序员的重要部分。因此我们将花时间讲解这些主题，以便随着程序复杂度提升，您的诊断和修复能力也能同步进阶。


若您有其他编程语言的调试经验，本章内容大多会感到熟悉。


语法错误（syntax error）  
----------------  

编程具有挑战性，而C++又是门充满特性的语言。两者结合时，犯错的方式将不胜枚举。错误通常分为两类：语法错误（syntax error）与语义错误（semantic error，亦称逻辑错误）。


**语法错误（syntax error）**指违反C++语法规则的语句。包括缺失分号、括号或花括号不匹配等错误。例如以下程序包含多个语法错误：

```cpp
#include <iostream>

int main( // 缺少右括号
{
    int 1x; // 变量名不能以数字开头
    std::cout << "Hi there"; << x +++ << '\n'; // 多余分号，+++运算符不存在
    return 0 // 语句末尾缺少分号
}
```

幸运的是，编译器会检测语法错误并发出警告或错误提示，方便您定位修复问题。只需反复编译直至消除所有错误。


语义错误（semantic error）  
----------------  

**语义错误（semantic error）**指语句在语法正确的情况下，要么违反语言其他规则，要么未实现程序员意图的错误。


部分语义错误可被编译器捕获。常见例子包括使用未声明变量、类型不匹配（在错误位置使用类型不符的对象）等：

```cpp
int main()
{
    5 = x; // x未声明，不能给5赋值
    return "hello"; // "hello"无法转换为int类型
}
```

其他语义错误仅在运行时显现。有些会导致程序崩溃，例如除以零的情况：

```cpp
#include <iostream>

int main()
{
    int a { 10 };
    int b { 0 };
    std::cout << a << " / " << b << " = " << a / b << '\n'; // 数学中除以零无定义
    return 0;
}
```

更多情况下则产生错误值或异常行为：

```cpp
#include <iostream>

int main()
{
    int x; // 未初始化变量
    std::cout << x << '\n'; // 使用未初始化变量导致未定义结果

    return 0;
}
```

或：

```cpp
#include <iostream>

int add(int x, int y) // 本函数应执行加法运算
{
    return x - y; // 但错误使用了减法运算符
}

int main()
{
    std::cout << "5 + 3 = " << add(5, 3) << '\n'; // 应输出8，实际输出2

    return 0;
}
```

或：

```cpp
#include <iostream>

int main()
{
    return 0; // 函数在此处返回

    std::cout << "Hello, world!\n"; // 此语句永不执行
}
```

上述示例中的错误较易察觉。但在复杂程序中，运行时语义错误难以通过肉眼发现。这正是调试技术发挥作用之处。


[下一课 3.2 — 调试流程](Chapter-3/lesson3.2-the-debugging-process.md)  
[返回主页](/)  
[上一课 2.x — 第2章总结与测验](Chapter-2/lesson2.x-chapter-2-summary-and-quiz.md)